var globalSearchObject="",globalPreviousValue="0.0",globalPreviousId="";function DismissOtherDropdown(requestType){var section_display="";if("section"!=requestType.toLowerCase()&&"block"==(section_display=$("#sectionChks")).css("display")){let checkboxes;document.getElementById("sectionChks").style.display="none",expanded=!1}if("dept"!=requestType.toLowerCase()&&(section_display="","block"==(section_display=$("#departmentChks")).css("display"))){let checkboxes;document.getElementById("departmentChks").style.display="none",expanded=!1}if("incharge"!=requestType.toLowerCase()&&(section_display="","block"==(section_display=$("#inchargeChks")).css("display"))){let checkboxes;document.getElementById("inchargeChks").style.display="none",expanded=!1}if("role"!=requestType.toLowerCase()&&(section_display="","block"==(section_display=$("#RoleChks")).css("display"))){let checkboxes;document.getElementById("RoleChks").style.display="none",expanded=!1}if("explanation"!=requestType.toLowerCase()&&(section_display="","block"==(section_display=$("#ExplanationChks")).css("display"))){let checkboxes;document.getElementById("ExplanationChks").style.display="none",expanded=!1}if("company"!=requestType.toLowerCase()&&(section_display="","block"==(section_display=$("#CompanyChks")).css("display"))){let checkboxes;document.getElementById("CompanyChks").style.display="none",expanded=!1}}function SectionCheck(){DismissOtherDropdown("section");var checkboxes=document.getElementById("sectionChks");expanded?(checkboxes.style.display="none",expanded=!1):(checkboxes.style.display="block",expanded=!0)}function DepartmentCheck(){DismissOtherDropdown("dept");var checkboxes=document.getElementById("departmentChks");expanded?(checkboxes.style.display="none",expanded=!1):(checkboxes.style.display="block",expanded=!0)}function InchargeCheck(){DismissOtherDropdown("incharge");var checkboxes=document.getElementById("inchargeChks");expanded?(checkboxes.style.display="none",expanded=!1):(checkboxes.style.display="block",expanded=!0)}function RoleCheck(){DismissOtherDropdown("role");var checkboxes=document.getElementById("RoleChks");expanded?(checkboxes.style.display="none",expanded=!1):(checkboxes.style.display="block",expanded=!0)}function ExplanationCheck(){DismissOtherDropdown("explanation");var checkboxes=document.getElementById("ExplanationChks");expanded?(checkboxes.style.display="none",expanded=!1):(checkboxes.style.display="block",expanded=!0)}function CompanyCheck(){DismissOtherDropdown("company");var checkboxes=document.getElementById("CompanyChks");expanded?(checkboxes.style.display="none",expanded=!1):(checkboxes.style.display="block",expanded=!0)}function LoadGradeValue(sel){var _rowId=$("#add_name_row_no_hidden").val(),_companyName=$("#company_row_"+_rowId).find(":selected").text(),_unitPrice=$("#add_name_unit_price_hidden").val();$.ajax({url:`/api/utilities/CompareGrade/${_unitPrice}`,type:"GET",dataType:"json",success:function(data){$("#grade_edit_hidden").val(data.Id),_companyName.toLowerCase().indexOf("mw")>0?$("#grade_row_"+_rowId).val(data.SalaryGrade):$("#grade_row_"+_rowId).val("")},error:function(){$("#grade_row_"+_rowId).val("")}})}function NameListSort(sort_asc,sort_desc){var nameAsc;"inline-block"==$("#"+sort_asc).css("display")?($("#"+sort_asc).css("display","none"),$("#"+sort_desc).css("display","inline-block")):($("#"+sort_asc).css("display","inline-block"),$("#"+sort_desc).css("display","none"))}function NameListSort_OnChange(){$("#name_asc").css("display","inline-block"),$("#name_desc").css("display","none"),$("#section_asc").css("display","inline-block"),$("#section_desc").css("display","none"),$("#department_asc").css("display","inline-block"),$("#department_desc").css("display","none"),$("#incharge_asc").css("display","inline-block"),$("#incharge_desc").css("display","none"),$("#role_asc").css("display","inline-block"),$("#role_desc").css("display","none"),$("#explanation_asc").css("display","inline-block"),$("#explanation_desc").css("display","none"),$("#company_asc").css("display","inline-block"),$("#company_desc").css("display","none"),$("#grade_asc").css("display","inline-block"),$("#grade_desc").css("display","none"),$("#unit_asc").css("display","inline-block"),$("#unit_desc").css("display","none")}function NameList_DatatableLoad(data){var tempCompanyName="",tempSubCode="",redMark="";$("#name-list").DataTable({destroy:!0,data:data,ordering:!0,orderCellsTop:!0,pageLength:100,searching:!1,bLengthChange:!1,columns:[{data:"EmployeeNameWithCodeRemarks",render:function(employeeNameWithCodeRemarks){var splittedString=employeeNameWithCodeRemarks.split("$");return"true"==splittedString[2]?`<span style='color:red;' class='namelist_addname' onClick="loadSingleAssignmentDataForExistingEmployee('${splittedString[0]}')" data-toggle="modal" data-target="#modal_add_name">${splittedString[1]}</span>`:`<span class='namelist_addname' onClick="loadSingleAssignmentDataForExistingEmployee('${splittedString[0]}')" data-toggle="modal" data-target="#modal_add_name">${splittedString[1]}</span>`}},{data:"SectionName"},{data:"DepartmentName"},{data:"InchargeName"},{data:"RoleName"},{data:"ExplanationName"},{data:"CompanyName",render:function(companyName){return tempCompanyName=companyName,companyName}},{data:"GradePoint",render:function(grade){return"mw"==tempCompanyName.toLowerCase()?grade:"<span style='display:none;'>"+grade+"</span>"}},{data:"UnitPrice"},{data:"Id",render:function(Id){return tempCompanyName.toLowerCase(),`<td class='namelist_td Action'><a href="javascript:void(0);" id='edit_button' onClick="loadSingleAssignmentData(${Id})" data-toggle="modal" data-target="#modal_edit_name">Edit</a><a id='delete_button' href='javascript:void();' data-toggle='modal' data-target='#namelist_delete' onClick="loadAssignmentRowData(${Id})" assignment_id='${Id}'>Inactive</a></td>`}}]})}function RetainRegistrationValue(){let name=$("#hid_name").val(),memo=$("#hid_memo").val(memo),sectionId=$("#hid_sectionId").val(sectionId),departmentId=$("#hid_departmentId").val(departmentId),inchargeId=$("#hid_inchargeId").val(inchargeId),roleId=$("#hid_roleId").val(roleId),explantionId=$("#hid_explanationId").val(explantionId),companyid=$("#hid_companyId").val(),companyName=$("#hid_companyName").val(),grade=$("#hid_grade").val(),unitPrice=$("#hid_unitPrice").val();$("#identity_new").val(name),$("#memo_new").val(memo),"mw"==companyName.toLowerCase()?$("#grade_new").val(grade):$("#grade_new").val(""),$("#unitprice_new").val(unitPrice)}function ForecastSearchDropdownInLoad(){$.getJSON("/api/sections/").done((function(data){$("#sectionChks").empty(),$("#sectionChks").append('<label for=\'chk_sec_all\'><input id="chk_sec_all" type="checkbox" checked data-checkwhat="chkSelect" value=\'sec_all\'/>All</label>'),$.each(data,(function(key,item){$("#sectionChks").append(`<label for='section_checkbox_${item.Id}'><input class='section_checkbox' id="section_checkbox_${item.Id}"  type="checkbox" checked value='${item.Id}'/>${item.SectionName}</label>`)}))})),$.getJSON("/api/Departments/").done((function(data){$("#departmentChks").empty(),$("#departmentChks").append("<label for='chk_dept_all'><input id=\"chk_dept_all\" type=\"checkbox\" checked value='dept_all'/>All</label>"),$.each(data,(function(key,item){$("#departmentChks").append(`<label for='department_checkbox_${item.Id}'><input class='department_checkbox' id="department_checkbox_${item.Id}" type="checkbox" checked value='${item.Id}'/>${item.DepartmentName}</label>`)}))})),$.getJSON("/api/InCharges/").done((function(data){$("#inchargeChks").empty(),$("#inchargeChks").append("<label for='chk_incharge_all'><input id=\"chk_incharge_all\" type=\"checkbox\" checked value='incharge_all'/>All</label>"),$.each(data,(function(key,item){$("#inchargeChks").append(`<label for='incharge_checkbox_${item.Id}'><input class='incharge_checkbox' id="incharge_checkbox_${item.Id}" type="checkbox" checked value='${item.Id}'/>${item.InChargeName}</label>`)}))})),$.getJSON("/api/Roles/").done((function(data){$("#RoleChks").empty(),$("#RoleChks").append("<label for='chk_role_all'><input id=\"chk_role_all\" type=\"checkbox\" checked value='role_all'/>All</label>"),$.each(data,(function(key,item){$("#RoleChks").append(`<label for='role_checkbox_${item.Id}'><input class='role_checkbox' id="role_checkbox_${item.Id}" type="checkbox" checked value='${item.Id}'/>${item.RoleName}</label>`)}))})),$.getJSON("/api/Explanations/").done((function(data){$("#ExplanationChks").empty(),$("#ExplanationChks").append("<label for='chk_explanation_all'><input id=\"chk_explanation_all\" type=\"checkbox\" checked value='explanation_all'/>All</label><br>"),$.each(data,(function(key,item){$("#ExplanationChks").append(`<label for='explanation_checkbox_${item.Id}'><input class='explanation_checkbox' id="explanation_checkbox_${item.Id}" type="checkbox" checked value='${item.Id}'/>${item.ExplanationName}</label><br>`)}))})),$.getJSON("/api/Companies/").done((function(data){$("#CompanyChks").empty(),$("#CompanyChks").append("<label for='chk_comopany_all'><input id=\"chk_comopany_all\" type=\"checkbox\" checked value='comopany_all'/>All</label>"),$.each(data,(function(key,item){$("#CompanyChks").append(`<label for='comopany_checkbox_${item.Id}'><input class='comopany_checkbox' id="comopany_checkbox_${item.Id}" type="checkbox" checked value='${item.Id}'/>${item.CompanyName}</label>`)}))}))}function CheckPreviousManMonthIdValuePoint(e){let clickedId=e.id;if(console.log("clickedId: "+clickedId),""==globalPreviousId&&(globalPreviousId=clickedId),globalPreviousId==clickedId){let pointValue=$("#"+e.id).val();globalPreviousValue=(isNaN(pointValue)||null==pointValue||""==pointValue)&&globalPreviousValue>0?globalPreviousValue:$("#"+e.id).val(),e.value<=0&&$("#"+e.id).val("")}else{let pointValue=$("#"+globalPreviousId).val();globalPreviousValue=(isNaN(pointValue)||null==pointValue||""==pointValue)&&globalPreviousValue>0?globalPreviousValue:$("#"+globalPreviousId).val(),e.value<=0&&$("#"+e.id).val(""),globalPreviousId=clickedId}console.log("clickedId: "+clickedId),console.log("globalPreviousId: "+globalPreviousId),console.log("globalPreviousValue: "+globalPreviousValue)}function checkPoint_click(e){console.log("click: "+globalPreviousValue);let pointValue=$("#"+e.id).val(),comparePreviousGlobalValue=parseFloat(globalPreviousValue);globalPreviousValue=(isNaN(pointValue)||null==pointValue||""==pointValue)&&comparePreviousGlobalValue>0?globalPreviousValue:comparePreviousGlobalValue>0?globalPreviousValue:"0.0",e.value<=0&&$("#"+e.id).val("")}function checkPoint_onmouseover(e){let pointValue=$("#"+e.id).val();globalPreviousValue=(isNaN(pointValue)||null==pointValue||""==pointValue)&&globalPreviousValue>0?globalPreviousValue:$("#"+e.id).val(),console.log(globalPreviousValue)}function checkPoint(element){var pointValue=$(element).val();isNaN(pointValue)||null==pointValue||""==pointValue?$(element).val(globalPreviousValue):pointValue>1||pointValue<0?(alert("total month point can not be grater than 1 Or less than 0"),$(element).val(globalPreviousValue)):$(element).val(pointValue);var totalMonthPoint=0,sameNameTr=[],tr=element.closest("tr"),trName=$(tr).find("td").eq(0).children("span").data("name"),allTr=$("#forecast_table > tbody > tr"),columnIndex=$(element).parent().index();$.each(allTr,(function(index,value){var tempTrName;if($(value).find("td").eq(0).children("span").data("name")==trName){var monthPoint=$(value).find("td").eq(columnIndex).children("input").val();totalMonthPoint+=""==monthPoint||NaN==monthPoint?0:parseFloat(monthPoint),sameNameTr.push(value)}})),totalMonthPoint>1&&(alert("total month point can not be grater than 1"),$(element).val(globalPreviousValue))}function LoaderShow(){$("#forecast_table_wrapper").css("display","none"),$("#loading").css("display","block")}function LoaderHide(){$("#forecast_table_wrapper").css("display","block"),$("#loading").css("display","none")}function LoadForecastData(){console.log("saved-3"),""!=globalSearchObject&&$.ajax({url:"/api/utilities/SearchForecastEmployee",contentType:"application/json",type:"GET",async:!0,dataType:"json",data:globalSearchObject,success:function(data){LoaderHide(),$("#forecast_table>thead").empty(),$("#forecast_table>tbody").empty(),$("#forecast_table>thead").append('\n                    <tr>\n                        <th id="forecast_name">Name </th>\n                        <th id="forecast_section">Section </th>\n                        <th id="forecast_department">Department </th>\n                        <th id="forecast_incharge">In-Charge </th>\n                        <th id="forecast_role">Role </th>\n                        <th id="forecast_explanation">Explanation </th>\n                        <th id="forecast_company">Company Name </i></th>\n                        <th id="forecast_grade">Grade </th>\n                        <th id="forecast_unitprice"><span>Unit Price</span> </th>\n                        <th>10月</th>\n                        <th>11月</th>\n                        <th>12月</th>\n                        <th>1月</th>\n                        <th>2月</th>\n                        <th>3月</th>\n                        <th>4月</th>\n                        <th>5月</th>\n                        <th>6月</th>\n                        <th>7月</th>\n                        <th>8月</th>\n                        <th>9月</th>\n                        <th>Oct</th>\n                        <th>Nov</th>\n                        <th>Dec</th>\n                        <th>Jan</th>\n                        <th>Feb</th>\n                        <th>Mar</th>\n                        <th>Apr</th>\n                        <th>May</th>\n                        <th>Jun</th>\n                        <th>Jul</th>\n                        <th>Aug</th>\n                        <th>Sep</th>\n                    </tr>\n                ');var _id=0,_companyName="",_oct=0,_octTotal=0;$("#forecast_table").DataTable({destroy:!0,data:data,searching:!1,bLengthChange:!1,autoWidth:!1,pageLength:100,columns:[{data:"EmployeeNameWithCodeRemarks",render:function(employeeNameWithCodeRemarks){var splittedString=employeeNameWithCodeRemarks.split("$");return _id=parseInt(splittedString[3]),"true"==splittedString[2]?`<span title='initial' data-name='${splittedString[0]}' style='color:red;'> ${splittedString[1]}</span> <input type='hidden' id='row_id_${_id}' value='${_id}'/>`:`<span title='initial' data-name='${splittedString[0]}'> ${splittedString[1]}</span> <input type='hidden' id='row_id_${_id}' value='${_id}'/>`}},{data:"SectionName",render:function(sectionName){return`<td title='initial'>${sectionName}</td>`}},{data:"DepartmentName",render:function(departmentName){return`<td title='initial'>${departmentName}</td>`}},{data:"InchargeName",render:function(inchargeName){return`<td title='initial'>${inchargeName}</td>`}},{data:"RoleName",render:function(roleName){return`<td title='initial'>${roleName}</td>`}},{data:"ExplanationName",render:function(explanationName){return`<span title='initial' class='forecast_explanation'>${explanationName}</span>`}},{data:"CompanyName",render:function(companyName){return _companyName=companyName,`<td title='initial'>${companyName}</td>`}},{data:"GradePoint",render:function(gradePoint){return"mw"==_companyName.toLowerCase()?`<td title='initial'>${gradePoint}</td>`:"<td title='initial'></td>"}},{data:"UnitPrice",render:function(unitPrice){return`<span id='up_${_id}' data-unitprice=${unitPrice}> ${unitPrice}</span>`}},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='oct_${_id}'  onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)"  data-month='10' value='${_forecast[0].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='oct_${_id}'  onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)"  data-month='10' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='nov_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='11' value='${_forecast[1].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='nov_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='11' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='dec_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='12' value='${_forecast[2].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='dec_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='12' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='jan_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='1' value='${_forecast[3].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='jan_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='1' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='feb_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='2' value='${_forecast[4].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='feb_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='2' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='mar_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='3' value='${_forecast[5].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='mar_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='3' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='apr_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='4' value='${_forecast[6].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='apr_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='4' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='may_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='5' value='${_forecast[7].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='may_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='5' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='jun_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='6' value='${_forecast[8].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='jun_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='6' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='jul_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='7' value='${_forecast[9].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='jul_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='7' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='aug_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='8' value='${_forecast[10].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='aug_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='8' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='sep_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='9' value='${_forecast[11].Points.toFixed(1)}' class='input_month'/></td>`:`<td><input type='text' id='sep_${_id}' onfocus ="checkPoint_onmouseover(this);" onclick="checkPoint_click(this)" onChange="checkPoint(this)" data-month='9' value='0.0' class='input_month'/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='oct_output_${_id}' value='${_forecast[0].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='oct_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='nov_output_${_id}' value='${_forecast[1].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='nov_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='dec_output_${_id}' value='${_forecast[2].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='dec_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='jan_output_${_id}' value='${_forecast[3].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='jan_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='feb_output_${_id}' value='${_forecast[4].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='feb_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='mar_output_${_id}' value='${_forecast[5].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='mar_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='apr_output_${_id}' value='${_forecast[6].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='apr_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='may_output_${_id}' value='${_forecast[7].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='may_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='jun_output_${_id}' value='${_forecast[8].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='jun_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='jul_output_${_id}' value='${_forecast[9].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='jul_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='aug_output_${_id}' value='${_forecast[10].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='aug_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1},{data:"forecasts",render:function(_forecast){return _forecast.length>0?`<td><input type='text' id='sep_output_${_id}' value='${_forecast[11].Total}' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`:`<td><input type='text' id='sep_output_${_id}' value='0' style='background-color:#E6E6E3;text-align:right;' readonly/></td>`},orderable:!1}]})},error:function(){$("#add_name_table_1 tbody").empty()}})}function onCancel(){LoaderShow(),LoadForecastData()}function onSave(e){e.preventDefault(),ForecastDataSave(),setTimeout(()=>{LoadForecastData(),ToastMessageSuccess("Data Saved Successfully")},5e3)}function ForecastDataSave(){var saveFlag=!1;const rows=document.querySelectorAll("#forecast_table > tbody > tr");if(rows.length<=0)return alert("No Rows Selected"),!1;LoaderShow(),$.each(rows,(function(index,data){var rowId=$(this).closest("tr").find("td").eq(0).children("input").val(),year=$("#period_search").find(":selected").val(),assignmentId=$("#row_id_"+rowId).val(),oct_point,oct_output,nov_point,nov_output,dec_point,dec_output,jan_point,jan_output,feb_point,feb_output,mar_point,mar_output,apr_point,apr_output,may_point,may_output,jun_point,jun_output,jul_point,jul_output,aug_point,aug_output,sep_point,sep_output,data=`10_${$("#oct_"+rowId).val().replace(/,/g,"")}_${$("#oct_output_"+rowId).val().replace(/,/g,"")},11_${$("#nov_"+rowId).val().replace(/,/g,"")}_${$("#nov_output_"+rowId).val().replace(/,/g,"")},12_${$("#dec_"+rowId).val().replace(/,/g,"")}_${$("#dec_output_"+rowId).val().replace(/,/g,"")},1_${$("#jan_"+rowId).val().replace(/,/g,"")}_${$("#jan_output_"+rowId).val().replace(/,/g,"")},2_${$("#feb_"+rowId).val().replace(/,/g,"")}_${$("#feb_output_"+rowId).val().replace(/,/g,"")},3_${$("#mar_"+rowId).val().replace(/,/g,"")}_${$("#mar_output_"+rowId).val().replace(/,/g,"")},4_${$("#apr_"+rowId).val().replace(/,/g,"")}_${$("#apr_output_"+rowId).val().replace(/,/g,"")},5_${$("#may_"+rowId).val().replace(/,/g,"")}_${$("#may_output_"+rowId).val().replace(/,/g,"")},6_${$("#jun_"+rowId).val().replace(/,/g,"")}_${$("#jun_output_"+rowId).val().replace(/,/g,"")},7_${$("#jul_"+rowId).val().replace(/,/g,"")}_${$("#jul_output_"+rowId).val().replace(/,/g,"")},8_${$("#aug_"+rowId).val().replace(/,/g,"")}_${$("#aug_output_"+rowId).val().replace(/,/g,"")},9_${$("#sep_"+rowId).val().replace(/,/g,"")}_${$("#sep_output_"+rowId).val().replace(/,/g,"")}`;$.ajax({url:"/api/Forecasts",type:"GET",async:!0,dataType:"json",data:{data:data,year:year,assignmentId:assignmentId},success:function(data){saveFlag=data,console.log("saved-1")},error:function(data){$("#loading").css("display","none"),saveFlag=!1,alert("Error please try again")}})}))}$("#department_modal_href").click((function(){$.getJSON("/api/sections/").done((function(data){$("#section_list").empty(),$("#section_list").append("<option value=''>Select Section</option>"),$.each(data,(function(key,item){$("#section_list").append(`<option value='${item.Id}'>&nbsp;&nbsp; ${item.SectionName}</option>`)}))}))}));var expanded=!1;function DeleteRecords(){$.getJSON("/api/utilities/DeleteAssignments/").done((function(data){}))}$(document).on("click",(function(event){var $trigger=$(".forecast_multiselect");$trigger===event.target||$trigger.has(event.target).length||($(".commonselect").slideUp("fast"),expanded=!1)})),$(document).ready((function(){var jss;$("#forecast_name").click((function(){NameListSort("name_asc","name_desc")})),$("#forecast_section").click((function(){NameListSort("section_asc","section_desc")})),$("#forecast_department").click((function(){NameListSort("department_asc","department_desc")})),$("#forecast_incharge").click((function(){NameListSort("incharge_asc","incharge_desc")})),$("#forecast_role").click((function(){NameListSort("role_asc","role_desc")})),$("#forecast_explanation").click((function(){NameListSort("explanation_asc","explanation_desc")})),$("#forecast_company").click((function(){NameListSort("company_asc","company_desc")})),$("#forecast_grade").click((function(){NameListSort("grade_asc","grade_desc")})),$("#forecast_unitprice").click((function(){NameListSort("unit_asc","unit_desc")})),$(document).on("click",'#sectionChks input[type="checkbox"]',(function(){let isSectionAllChk=$("#chk_sec_all").is(":checked");var isDepartmentAllCheck=$("#chk_dept_all").is(":checked"),isInChargeAllCheck=$("#chk_incharge_all").is(":checked"),isRoleAllCheck=$("#chk_role_all").is(":checked"),isExplanationAllCheck=$("#chk_explanation_all").is(":checked"),isCompanytAllCheck=$("#chk_comopany_all").is(":checked"),clicked_checkbox=$(this).attr("id");"chk_sec_all"==clicked_checkbox.toLowerCase()?$(".section_checkbox").prop("checked",isSectionAllChk):$("#chk_sec_all").prop("checked",!1),clicked_checkbox="";var employeeName="",sectionCheck=[],departmentCheck=[],inchargeCheck=[],roleCheck=[],explanationCheck=[],companyCheck=[];employeeName=$("#name_search").val();var sectionCheckedBoxes=$('#sectionChks input[type="checkbox"]:checked'),departmentCheckedBoxes=$('#departmentChks input[type="checkbox"]:checked'),inchargeCheckedBoxes=$('#inchargeChks input[type="checkbox"]:checked'),roleCheckedBoxes=$('#RoleChks input[type="checkbox"]:checked'),explanationCheckedBoxes=$('#ExplanationChks input[type="checkbox"]:checked'),companyCheckedBoxes=$('#CompanyChks input[type="checkbox"]:checked');$("#hidSectionId").val(""),isSectionAllChk||$.each(sectionCheckedBoxes,(function(index,item){sectionCheck.push(item.value)})),$("#hidSectionId").val(sectionCheck),$("#hidDepartmentId").val(""),isDepartmentAllCheck||$.each(departmentCheckedBoxes,(function(index,item){departmentCheck.push(item.value)})),$("#hidDepartmentId").val(departmentCheck),$("#hidInChargeId").val(""),isInChargeAllCheck||$.each(inchargeCheckedBoxes,(function(index,item){inchargeCheck.push(item.value)})),$("#hidInChargeId").val(inchargeCheck),$("#hidRoleId").val(""),isRoleAllCheck||$.each(roleCheckedBoxes,(function(index,item){roleCheck.push(item.value)})),$("#hidRoleId").val(roleCheck),$("#hidExplanationId").val(""),isExplanationAllCheck||$.each(explanationCheckedBoxes,(function(index,item){explanationCheck.push(item.value)})),$("#hidExplanationId").val(explanationCheck),$("#hidCompanyid").val(""),isCompanytAllCheck||$.each(companyCheckedBoxes,(function(index,item){companyCheck.push(item.value)})),$("#hidCompanyid").val(companyCheck)})),$(document).on("click",'#departmentChks input[type="checkbox"]',(function(){let isSectionAllChk=$("#chk_sec_all").is(":checked");var isDepartmentAllCheck=$("#chk_dept_all").is(":checked"),isInChargeAllCheck=$("#chk_incharge_all").is(":checked"),isRoleAllCheck=$("#chk_role_all").is(":checked"),isExplanationAllCheck=$("#chk_explanation_all").is(":checked"),isCompanytAllCheck=$("#chk_comopany_all").is(":checked"),clicked_checkbox;"chk_dept_all"==$(this).attr("id").toLowerCase()?$(".department_checkbox").prop("checked",isDepartmentAllCheck):$("#chk_dept_all").prop("checked",!1);var employeeName="",sectionCheck=[],departmentCheck=[],inchargeCheck=[],roleCheck=[],explanationCheck=[],companyCheck=[];employeeName=$("#name_search").val();var sectionCheckedBoxes=$('#sectionChks input[type="checkbox"]:checked'),departmentCheckedBoxes=$('#departmentChks input[type="checkbox"]:checked'),inchargeCheckedBoxes=$('#inchargeChks input[type="checkbox"]:checked'),roleCheckedBoxes=$('#RoleChks input[type="checkbox"]:checked'),explanationCheckedBoxes=$('#ExplanationChks input[type="checkbox"]:checked'),companyCheckedBoxes=$('#CompanyChks input[type="checkbox"]:checked');$("#hidSectionId").val(""),isSectionAllChk||$.each(sectionCheckedBoxes,(function(index,item){sectionCheck.push(item.value)})),$("#hidSectionId").val(sectionCheck),$("#hidDepartmentId").val(""),isDepartmentAllCheck||$.each(departmentCheckedBoxes,(function(index,item){departmentCheck.push(item.value)})),$("#hidDepartmentId").val(departmentCheck),$("#hidInChargeId").val(""),isInChargeAllCheck||$.each(inchargeCheckedBoxes,(function(index,item){inchargeCheck.push(item.value)})),$("#hidInChargeId").val(inchargeCheck),$("#hidRoleId").val(""),isRoleAllCheck||$.each(roleCheckedBoxes,(function(index,item){roleCheck.push(item.value)})),$("#hidRoleId").val(roleCheck),$("#hidExplanationId").val(""),isExplanationAllCheck||$.each(explanationCheckedBoxes,(function(index,item){explanationCheck.push(item.value)})),$("#hidExplanationId").val(explanationCheck),$("#hidCompanyid").val(""),isCompanytAllCheck||$.each(companyCheckedBoxes,(function(index,item){companyCheck.push(item.value)})),$("#hidCompanyid").val(companyCheck)})),$(document).on("click",'#inchargeChks input[type="checkbox"]',(function(){let isSectionAllChk=$("#chk_sec_all").is(":checked");var isDepartmentAllCheck=$("#chk_dept_all").is(":checked"),isInChargeAllCheck=$("#chk_incharge_all").is(":checked"),isRoleAllCheck=$("#chk_role_all").is(":checked"),isExplanationAllCheck=$("#chk_explanation_all").is(":checked"),isCompanytAllCheck=$("#chk_comopany_all").is(":checked"),clicked_checkbox;"chk_incharge_all"==$(this).attr("id").toLowerCase()?$(".incharge_checkbox").prop("checked",isInChargeAllCheck):$("#chk_incharge_all").prop("checked",!1);var employeeName="",sectionCheck=[],departmentCheck=[],inchargeCheck=[],roleCheck=[],explanationCheck=[],companyCheck=[];employeeName=$("#name_search").val();var sectionCheckedBoxes=$('#sectionChks input[type="checkbox"]:checked'),departmentCheckedBoxes=$('#departmentChks input[type="checkbox"]:checked'),inchargeCheckedBoxes=$('#inchargeChks input[type="checkbox"]:checked'),roleCheckedBoxes=$('#RoleChks input[type="checkbox"]:checked'),explanationCheckedBoxes=$('#ExplanationChks input[type="checkbox"]:checked'),companyCheckedBoxes=$('#CompanyChks input[type="checkbox"]:checked');$("#hidSectionId").val(""),isSectionAllChk||$.each(sectionCheckedBoxes,(function(index,item){sectionCheck.push(item.value)})),$("#hidSectionId").val(sectionCheck),$("#hidDepartmentId").val(""),isDepartmentAllCheck||$.each(departmentCheckedBoxes,(function(index,item){departmentCheck.push(item.value)})),$("#hidDepartmentId").val(departmentCheck),$("#hidInChargeId").val(""),isInChargeAllCheck||$.each(inchargeCheckedBoxes,(function(index,item){inchargeCheck.push(item.value)})),$("#hidInChargeId").val(inchargeCheck),$("#hidRoleId").val(""),isRoleAllCheck||$.each(roleCheckedBoxes,(function(index,item){roleCheck.push(item.value)})),$("#hidRoleId").val(roleCheck),$("#hidExplanationId").val(""),isExplanationAllCheck||$.each(explanationCheckedBoxes,(function(index,item){explanationCheck.push(item.value)})),$("#hidExplanationId").val(explanationCheck),$("#hidCompanyid").val(""),isCompanytAllCheck||$.each(companyCheckedBoxes,(function(index,item){companyCheck.push(item.value)})),$("#hidCompanyid").val(companyCheck)})),$(document).on("click",'#RoleChks input[type="checkbox"]',(function(){let isSectionAllChk=$("#chk_sec_all").is(":checked");var isDepartmentAllCheck=$("#chk_dept_all").is(":checked"),isInChargeAllCheck=$("#chk_incharge_all").is(":checked"),isRoleAllCheck=$("#chk_role_all").is(":checked"),isExplanationAllCheck=$("#chk_explanation_all").is(":checked"),isCompanytAllCheck=$("#chk_comopany_all").is(":checked"),clicked_checkbox;"chk_role_all"==$(this).attr("id").toLowerCase()?$(".role_checkbox").prop("checked",isRoleAllCheck):$("#chk_role_all").prop("checked",!1);var employeeName="",sectionCheck=[],departmentCheck=[],inchargeCheck=[],roleCheck=[],explanationCheck=[],companyCheck=[];employeeName=$("#name_search").val();var sectionCheckedBoxes=$('#sectionChks input[type="checkbox"]:checked'),departmentCheckedBoxes=$('#departmentChks input[type="checkbox"]:checked'),inchargeCheckedBoxes=$('#inchargeChks input[type="checkbox"]:checked'),roleCheckedBoxes=$('#RoleChks input[type="checkbox"]:checked'),explanationCheckedBoxes=$('#ExplanationChks input[type="checkbox"]:checked'),companyCheckedBoxes=$('#CompanyChks input[type="checkbox"]:checked');$("#hidSectionId").val(""),isSectionAllChk||$.each(sectionCheckedBoxes,(function(index,item){sectionCheck.push(item.value)})),$("#hidSectionId").val(sectionCheck),$("#hidDepartmentId").val(""),isDepartmentAllCheck||$.each(departmentCheckedBoxes,(function(index,item){departmentCheck.push(item.value)})),$("#hidDepartmentId").val(departmentCheck),$("#hidInChargeId").val(""),isInChargeAllCheck||$.each(inchargeCheckedBoxes,(function(index,item){inchargeCheck.push(item.value)})),$("#hidInChargeId").val(inchargeCheck),$("#hidRoleId").val(""),isRoleAllCheck||$.each(roleCheckedBoxes,(function(index,item){roleCheck.push(item.value)})),$("#hidRoleId").val(roleCheck),$("#hidExplanationId").val(""),isExplanationAllCheck||$.each(explanationCheckedBoxes,(function(index,item){explanationCheck.push(item.value)})),$("#hidExplanationId").val(explanationCheck),$("#hidCompanyid").val(""),isCompanytAllCheck||$.each(companyCheckedBoxes,(function(index,item){companyCheck.push(item.value)})),$("#hidCompanyid").val(companyCheck)})),$(document).on("click",'#ExplanationChks input[type="checkbox"]',(function(){let isSectionAllChk=$("#chk_sec_all").is(":checked");var isDepartmentAllCheck=$("#chk_dept_all").is(":checked"),isInChargeAllCheck=$("#chk_incharge_all").is(":checked"),isRoleAllCheck=$("#chk_role_all").is(":checked"),isExplanationAllCheck=$("#chk_explanation_all").is(":checked"),isCompanytAllCheck=$("#chk_comopany_all").is(":checked"),clicked_checkbox;"chk_explanation_all"==$(this).attr("id").toLowerCase()?$(".explanation_checkbox").prop("checked",isExplanationAllCheck):$("#chk_explanation_all").prop("checked",!1);var employeeName="",sectionCheck=[],departmentCheck=[],inchargeCheck=[],roleCheck=[],explanationCheck=[],companyCheck=[];employeeName=$("#name_search").val();var sectionCheckedBoxes=$('#sectionChks input[type="checkbox"]:checked'),departmentCheckedBoxes=$('#departmentChks input[type="checkbox"]:checked'),inchargeCheckedBoxes=$('#inchargeChks input[type="checkbox"]:checked'),roleCheckedBoxes=$('#RoleChks input[type="checkbox"]:checked'),explanationCheckedBoxes=$('#ExplanationChks input[type="checkbox"]:checked'),companyCheckedBoxes=$('#CompanyChks input[type="checkbox"]:checked');$("#hidSectionId").val(""),isSectionAllChk||$.each(sectionCheckedBoxes,(function(index,item){sectionCheck.push(item.value)})),$("#hidSectionId").val(sectionCheck),$("#hidDepartmentId").val(""),isDepartmentAllCheck||$.each(departmentCheckedBoxes,(function(index,item){departmentCheck.push(item.value)})),$("#hidDepartmentId").val(departmentCheck),$("#hidInChargeId").val(""),isInChargeAllCheck||$.each(inchargeCheckedBoxes,(function(index,item){inchargeCheck.push(item.value)})),$("#hidInChargeId").val(inchargeCheck),$("#hidRoleId").val(""),isRoleAllCheck||$.each(roleCheckedBoxes,(function(index,item){roleCheck.push(item.value)})),$("#hidRoleId").val(roleCheck),$("#hidExplanationId").val(""),isExplanationAllCheck||$.each(explanationCheckedBoxes,(function(index,item){explanationCheck.push(item.value)})),$("#hidExplanationId").val(explanationCheck),$("#hidCompanyid").val(""),isCompanytAllCheck||$.each(companyCheckedBoxes,(function(index,item){companyCheck.push(item.value)})),$("#hidCompanyid").val(companyCheck)})),$(document).on("click",'#CompanyChks input[type="checkbox"]',(function(){let isSectionAllChk=$("#chk_sec_all").is(":checked");var isDepartmentAllCheck=$("#chk_dept_all").is(":checked"),isInChargeAllCheck=$("#chk_incharge_all").is(":checked"),isRoleAllCheck=$("#chk_role_all").is(":checked"),isExplanationAllCheck=$("#chk_explanation_all").is(":checked"),isCompanytAllCheck=$("#chk_comopany_all").is(":checked"),clicked_checkbox;"chk_comopany_all"==$(this).attr("id").toLowerCase()?$(".comopany_checkbox").prop("checked",isCompanytAllCheck):$("#chk_comopany_all").prop("checked",!1);var employeeName="",sectionCheck=[],departmentCheck=[],inchargeCheck=[],roleCheck=[],explanationCheck=[],companyCheck=[];employeeName=$("#name_search").val();var sectionCheckedBoxes=$('#sectionChks input[type="checkbox"]:checked'),departmentCheckedBoxes=$('#departmentChks input[type="checkbox"]:checked'),inchargeCheckedBoxes=$('#inchargeChks input[type="checkbox"]:checked'),roleCheckedBoxes=$('#RoleChks input[type="checkbox"]:checked'),explanationCheckedBoxes=$('#ExplanationChks input[type="checkbox"]:checked'),companyCheckedBoxes=$('#CompanyChks input[type="checkbox"]:checked');$("#hidSectionId").val(""),isSectionAllChk||$.each(sectionCheckedBoxes,(function(index,item){sectionCheck.push(item.value)})),$("#hidSectionId").val(sectionCheck),$("#hidDepartmentId").val(""),isDepartmentAllCheck||$.each(departmentCheckedBoxes,(function(index,item){departmentCheck.push(item.value)})),$("#hidDepartmentId").val(departmentCheck),$("#hidInChargeId").val(""),isInChargeAllCheck||$.each(inchargeCheckedBoxes,(function(index,item){inchargeCheck.push(item.value)})),$("#hidInChargeId").val(inchargeCheck),$("#hidRoleId").val(""),isRoleAllCheck||$.each(roleCheckedBoxes,(function(index,item){roleCheck.push(item.value)})),$("#hidRoleId").val(roleCheck),$("#hidExplanationId").val(""),isExplanationAllCheck||$.each(explanationCheckedBoxes,(function(index,item){explanationCheck.push(item.value)})),$("#hidExplanationId").val(explanationCheck),$("#hidCompanyid").val(""),isCompanytAllCheck||$.each(companyCheckedBoxes,(function(index,item){companyCheck.push(item.value)})),$("#hidCompanyid").val(companyCheck)})),ForecastSearchDropdownInLoad(),$("#forecast_table").on("change",".input_month",(function(){var rowId=$(this).closest("tr").find("td").eq(0).children("input").val(),month=parseInt($(this).data("month")),unitPrice=parseFloat($("#up_"+rowId).data("unitprice").replace(/,/g,"")),pointValue=parseFloat($(this).val());let result=0;switch(month){case 1:result=unitPrice*pointValue,$("#jan_output_"+rowId).val(result.toLocaleString());break;case 2:result=unitPrice*pointValue,$("#feb_output_"+rowId).val(result.toLocaleString());break;case 3:result=unitPrice*pointValue,$("#mar_output_"+rowId).val(result.toLocaleString());break;case 4:result=unitPrice*pointValue,$("#apr_output_"+rowId).val(result.toLocaleString());break;case 5:result=unitPrice*pointValue,$("#may_output_"+rowId).val(result.toLocaleString());break;case 6:result=unitPrice*pointValue,$("#jun_output_"+rowId).val(result.toLocaleString());break;case 7:result=unitPrice*pointValue,$("#jul_output_"+rowId).val(result.toLocaleString());break;case 8:result=unitPrice*pointValue,$("#aug_output_"+rowId).val(result.toLocaleString());break;case 9:result=unitPrice*pointValue,$("#sep_output_"+rowId).val(result.toLocaleString());break;case 10:result=unitPrice*pointValue,$("#oct_output_"+rowId).val(result.toLocaleString());break;case 11:result=unitPrice*pointValue,$("#nov_output_"+rowId).val(result.toLocaleString());break;case 12:result=unitPrice*pointValue,$("#dec_output_"+rowId).val(result.toLocaleString())}}));var jssUpdatedData=[],jssInsertedData=[];$("#forecast_search_button").on("click",(function(){var sectionId=$("#section_search").find(":selected").val(),inchargeId=$("#incharge_search").find(":selected").val(),departmentId=$("#department_search").find(":selected").val(),roleId=$("#role_search").find(":selected").val(),companyId=$("#company_search").find(":selected").val(),explanationId=$("#explanation_search").find(":selected").val(),employeeName=$("#identity_search").val(),year=$("#period_search").find(":selected").val();if(""==year||null==year)return alert("select year"),!1;LoaderShow(),$("#cancel_forecast").css("display","inline-block"),$("#save_forecast").css("display","inline-block");let isSectionAllChk=$("#chk_sec_all").is(":checked");var isDepartmentAllCheck=$("#chk_dept_all").is(":checked"),isInChargeAllCheck=$("#chk_incharge_all").is(":checked"),isRoleAllCheck=$("#chk_role_all").is(":checked"),isExplanationAllCheck=$("#chk_explanation_all").is(":checked"),isCompanytAllCheck=$("#chk_comopany_all").is(":checked"),sectionCheck=[],departmentCheck=[],inchargeCheck=[],roleCheck=[],explanationCheck=[],companyCheck=[],sectionCheckedBoxes=$('#sectionChks input[type="checkbox"]:checked'),departmentCheckedBoxes=$('#departmentChks input[type="checkbox"]:checked'),inchargeCheckedBoxes=$('#inchargeChks input[type="checkbox"]:checked'),roleCheckedBoxes=$('#RoleChks input[type="checkbox"]:checked'),explanationCheckedBoxes=$('#ExplanationChks input[type="checkbox"]:checked'),companyCheckedBoxes=$('#CompanyChks input[type="checkbox"]:checked'),data_info;sectionId="",isSectionAllChk||$.each(sectionCheckedBoxes,(function(index,item){sectionId=""==sectionId?item.value:sectionId+"##"+item.value})),departmentId="",isDepartmentAllCheck||$.each(departmentCheckedBoxes,(function(index,item){departmentId=""==departmentId?item.value:departmentId+"##"+item.value})),inchargeId="",isInChargeAllCheck||$.each(inchargeCheckedBoxes,(function(index,item){inchargeId=""==inchargeId?item.value:inchargeId+"##"+item.value})),roleId="",isRoleAllCheck||$.each(roleCheckedBoxes,(function(index,item){roleId=""==roleId?item.value:roleId+"##"+item.value})),explanationId="",isExplanationAllCheck||$.each(explanationCheckedBoxes,(function(index,item){explanationId=""==explanationId?item.value:explanationId+"##"+item.value})),companyId="",isCompanytAllCheck||$.each(companyCheckedBoxes,(function(index,item){companyId=""==companyId?item.value:companyId+"##"+item.value})),globalSearchObject={employeeName:employeeName,sectionId:sectionId,departmentId:departmentId,inchargeId:inchargeId,roleId:roleId,explanationId:explanationId,companyId:companyId,status:"",year:"",timeStampId:""};var _retriveddata=[];$.ajax({url:"/api/utilities/SearchForecastEmployee",contentType:"application/json",type:"GET",async:!1,dataType:"json",data:globalSearchObject,success:function(data){_retriveddata=data}}),$.ajax({url:"/api/utilities/GetTimeStamps",contentType:"application/json",type:"GET",async:!1,dataType:"json",data:{year:year},success:function(data){$("#forecast_timestamp").empty(),$("#forecast_timestamp").append("<option value=''>Select Item</option>"),$.each(data,(function(index,element){$("#forecast_timestamp").append(`<option value='${element.Id}'>${element.TimeStamp}</option>`)}))}});var sectionsForJexcel=[],departmentsForJexcel=[],inchargesForJexcel=[],rolesForJexcel=[],explanationsForJexcel=[],companiesForJexcel=[],gradesForJexcel=[];$.ajax({url:"/api/Sections",contentType:"application/json",type:"GET",async:!1,dataType:"json",success:function(data){$.each(data,(index,value)=>{sectionsForJexcel.push({id:value.Id,name:value.SectionName})})}}),$.ajax({url:"/api/Departments",contentType:"application/json",type:"GET",async:!1,dataType:"json",success:function(data){$.each(data,(index,value)=>{departmentsForJexcel.push({id:value.Id,name:value.DepartmentName})}),console.log(data)}}),$.ajax({url:"/api/InCharges",contentType:"application/json",type:"GET",async:!1,dataType:"json",success:function(data){$.each(data,(index,value)=>{inchargesForJexcel.push({id:value.Id,name:value.InChargeName})})}}),$.ajax({url:"/api/Roles",contentType:"application/json",type:"GET",async:!1,dataType:"json",success:function(data){$.each(data,(index,value)=>{rolesForJexcel.push({id:value.Id,name:value.RoleName})})}}),$.ajax({url:"/api/Explanations",contentType:"application/json",type:"GET",async:!1,dataType:"json",success:function(data){$.each(data,(index,value)=>{explanationsForJexcel.push({id:value.Id,name:value.ExplanationName})})}}),$.ajax({url:"/api/Companies",contentType:"application/json",type:"GET",async:!1,dataType:"json",success:function(data){$.each(data,(index,value)=>{companiesForJexcel.push({id:value.Id,name:value.CompanyName})})}}),$.ajax({url:"/api/Salaries",contentType:"application/json",type:"GET",async:!1,dataType:"json",success:function(data){$.each(data,(index,value)=>{gradesForJexcel.push({id:value.Id,name:value.SalaryGrade})})}}),null!=jss&&(jss.destroy(),$("#jspreadsheet").empty()),(jss=$("#jspreadsheet").jspreadsheet({data:_retriveddata,tableOverflow:!0,lazyLoading:!0,columns:[{title:"Id",type:"hidden",name:"Id"},{title:"Employee Name",name:"EmployeeName",width:150},{title:"Section Name",type:"dropdown",source:sectionsForJexcel,name:"SectionId",width:85},{title:"Department Name",type:"dropdown",source:departmentsForJexcel,name:"DepartmentId",width:85},{title:"Incharge Name",type:"dropdown",source:inchargesForJexcel,name:"InchargeId",width:85},{title:"Role Name",type:"dropdown",source:rolesForJexcel,name:"RoleId",width:85},{title:"Explanation Name",type:"dropdown",source:explanationsForJexcel,name:"ExplanationId",width:150},{title:"Company Name",type:"dropdown",source:companiesForJexcel,name:"CompanyId",width:85},{title:"Grade",type:"dropdown",source:gradesForJexcel,name:"GradeId"},{title:"Unit Price",type:"number",name:"UnitPrice",mask:"#,##0",width:85},{title:"10",type:"decimal",name:"OctPoints"},{title:"11",type:"decimal",name:"NovPoints"},{title:"12",type:"decimal",name:"DecPoints"},{title:"1",type:"decimal",name:"JanPoints"},{title:"2",type:"decimal",name:"FebPoints"},{title:"3",type:"decimal",name:"MarPoints"},{title:"4",type:"decimal",name:"AprPoints"},{title:"5",type:"decimal",name:"MayPoints"},{title:"6",type:"decimal",name:"JunPoints"},{title:"7",type:"decimal",name:"JulPoints"},{title:"8",type:"decimal",name:"AugPoints"},{title:"9",type:"decimal",name:"SepPoints"},{title:"10",type:"number",readOnly:!0,mask:"#,##0",name:"OctTotal"},{title:"11",type:"decimal",readOnly:!0,mask:"#,##0",name:"NovTotal"},{title:"12",type:"decimal",readOnly:!0,mask:"#,##0",name:"DecTotal"},{title:"1",type:"decimal",readOnly:!0,name:"JanTotal"},{title:"2",type:"decimal",readOnly:!0,mask:"#,##0",name:"FebTotal"},{title:"3",type:"decimal",readOnly:!0,mask:"#,##0",name:"MarTotal"},{title:"4",type:"decimal",readOnly:!0,name:"AprTotal"},{title:"5",type:"decimal",readOnly:!0,mask:"#,##0",name:"MayTotal"},{title:"6",type:"decimal",readOnly:!0,mask:"#,##0",name:"JunTotal"},{title:"7",type:"decimal",readOnly:!0,name:"JulTotal"},{title:"8",type:"decimal",readOnly:!0,mask:"#,##0",name:"AugTotal"},{title:"9",type:"decimal",readOnly:!0,mask:"#,##0",name:"SepTotal"}],columnSorting:!0,onchange:changed,oninsertrow:newRowInserted})).deleteColumn(34,15)}));var newRowCount=1,changed=function(instance,cell,x,y,value){var checkId=jss.getValueFromCoords(0,y),retrivedData=retrivedObject(jss.getRowData(y)),dataCheck=jssUpdatedData.filter(d=>d.assignmentId==retrivedData.assignmentId);10==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),11==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),12==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),13==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),14==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),15==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),16==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),17==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),18==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),19==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),20==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red")),21==x&&(isNaN(value)||x<0?(alert("Input not valid"),jss.setValueFromCoords(x,y,"0",!1)):0==dataCheck.length?jssUpdatedData.push(retrivedData):updateArray(jssUpdatedData,retrivedData),$(cell).css("color","red"))},newRowInserted=function(instance,x,y,newRow){};function updateArray(array,retrivedData){var index=jssUpdatedData.findIndex(d=>d.assignmentId==retrivedData.assignmentId);array[index].octPoint=retrivedData.octPoint,array[index].novPoint=retrivedData.novPoint,array[index].decPoint=retrivedData.decPoint,array[index].janPoint=retrivedData.janPoint,array[index].febPoint=retrivedData.febPoint,array[index].marPoint=retrivedData.marPoint,array[index].aprPoint=retrivedData.aprPoint,array[index].mayPoint=retrivedData.mayPoint,array[index].junPoint=retrivedData.junPoint,array[index].julPoint=retrivedData.julPoint,array[index].augPoint=retrivedData.augPoint,array[index].sepPoint=retrivedData.sepPoint,array[index].year=retrivedData.year}function updateArrayForInsert(array,retrivedData){var index=jssInsertedData.findIndex(d=>d.assignmentId==retrivedData.assignmentId);array[index].employeeName=retrivedData.employeeName,array[index].sectionId=retrivedData.sectionId,array[index].departmentId=retrivedData.departmentId,array[index].inchargeId=retrivedData.inchargeId,array[index].roleId=retrivedData.roleId,array[index].explanationId=retrivedData.explanationId,array[index].companyId=retrivedData.companyId,array[index].gradeId=retrivedData.gradeId,array[index].octPoint=retrivedData.octPoint,array[index].novPoint=retrivedData.novPoint,array[index].decPoint=retrivedData.decPoint,array[index].janPoint=retrivedData.janPoint,array[index].febPoint=retrivedData.febPoint,array[index].marPoint=retrivedData.marPoint,array[index].aprPoint=retrivedData.aprPoint,array[index].mayPoint=retrivedData.mayPoint,array[index].junPoint=retrivedData.junPoint,array[index].julPoint=retrivedData.julPoint,array[index].augPoint=retrivedData.augPoint,array[index].sepPoint=retrivedData.sepPoint,array[index].year=retrivedData.year}function retrivedObject(rowData){return{assignmentId:parseInt(rowData[0]),employeeName:rowData[1],sectionId:rowData[2],departmentId:rowData[3],inchargeId:rowData[4],roleId:rowData[5],explanationId:rowData[6],companyId:rowData[7],gradeId:rowData[8],unitPrice:parseFloat(rowData[9]),octPoint:parseFloat(rowData[10]),novPoint:parseFloat(rowData[11]),decPoint:parseFloat(rowData[12]),janPoint:parseFloat(rowData[13]),febPoint:parseFloat(rowData[14]),marPoint:parseFloat(rowData[15]),aprPoint:parseFloat(rowData[16]),mayPoint:parseFloat(rowData[17]),junPoint:parseFloat(rowData[18]),julPoint:parseFloat(rowData[19]),augPoint:parseFloat(rowData[20]),sepPoint:parseFloat(rowData[21]),year:2023}}$("#forecast_timestamp").on("change",(function(){var timeStampId=$(this).val();if(jssUpdatedData=[],""==timeStampId)return alert("Select Item"),!1;globalSearchObject.timeStampId=timeStampId,null!=jss&&(jss.destroy(),$("#jspreadsheet").empty());var _retriveddata=[];$.ajax({url:"/api/utilities/SearchForecastEmployee",contentType:"application/json",type:"GET",async:!1,dataType:"json",data:globalSearchObject,success:function(data){_retriveddata=data}}),(jss=$("#jspreadsheet").jspreadsheet({data:_retriveddata,columns:[{title:"Id",type:"hidden",name:"Id"},{title:"Employee Name",name:"EmployeeName",width:150},{title:"Section Name",name:"SectionName",width:85},{title:"Department Name",name:"DepartmentName",width:85},{title:"Incharge Name",name:"InchargeName",width:85},{title:"Role Name",name:"RoleName",width:85},{title:"Explanation Name",name:"ExplanationName",width:150},{title:"Company Name",name:"CompanyName",width:85},{title:"Grade",name:"GradePoint"},{title:"Unit Price",name:"UnitPrice",type:"number",mask:"#,##0",width:85},{title:"10",type:"decimal",name:"OctPoints"},{title:"11",type:"decimal",name:"NovPoints"},{title:"12",type:"decimal",name:"DecPoints"},{title:"1",type:"decimal",name:"JanPoints"},{title:"2",type:"decimal",name:"FebPoints"},{title:"3",type:"decimal",name:"MarPoints"},{title:"4",type:"decimal",name:"AprPoints"},{title:"5",type:"decimal",name:"MayPoints"},{title:"6",type:"decimal",name:"JunPoints"},{title:"7",type:"decimal",name:"JulPoints"},{title:"8",type:"decimal",name:"AugPoints"},{title:"9",type:"decimal",name:"SepPoints"},{title:"10",type:"number",readOnly:!0,mask:"#,##0",name:"OctTotal"},{title:"11",type:"decimal",readOnly:!0,mask:"#,##0",name:"NovTotal"},{title:"12",type:"decimal",readOnly:!0,mask:"#,##0",name:"DecTotal"},{title:"1",type:"decimal",readOnly:!0,name:"JanTotal"},{title:"2",type:"decimal",readOnly:!0,mask:"#,##0",name:"FebTotal"},{title:"3",type:"decimal",readOnly:!0,mask:"#,##0",name:"MarTotal"},{title:"4",type:"decimal",readOnly:!0,name:"AprTotal"},{title:"5",type:"decimal",readOnly:!0,mask:"#,##0",name:"MayTotal"},{title:"6",type:"decimal",readOnly:!0,mask:"#,##0",name:"JunTotal"},{title:"7",type:"decimal",readOnly:!0,name:"JulTotal"},{title:"8",type:"decimal",readOnly:!0,mask:"#,##0",name:"AugTotal"},{title:"9",type:"decimal",readOnly:!0,mask:"#,##0",name:"SepTotal"}],columnSorting:!0,onchange:changed})).deleteColumn(34,15)})),$("#update_forecast_history").on("click",(function(){if(!(jssUpdatedData.length>0))return alert("no recored found to update!!!"),!1;console.log(jssUpdatedData),$.ajax({url:"/api/utilities/CreateHistory",contentType:"application/json",type:"POST",async:!1,dataType:"json",data:JSON.stringify(jssUpdatedData),success:function(data){alert("success!!")}})})),$(document).on("change","#section_search",(function(){var sectionId=$(this).val();$.getJSON(`/api/utilities/DepartmentsBySection/${sectionId}`).done((function(data){$("#department_search").empty(),$("#department_search").append("<option value=''>Select Department</option>"),$.each(data,(function(key,item){$("#department_search").append(`<option value='${item.Id}'>${item.DepartmentName}</option>`)}))}))}))}));